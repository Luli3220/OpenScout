{
  "username": "suriyadeepan",
  "agent_b_context": "\n=== PR #37 in Michael-OMahony/ml-labs-bootcamp-group-5 (Stars: 3) ===\nFile: src/features/common.py\nPatch:\n@@ -51,7 +51,11 @@ def postproc_categorical(feats, pipe=None, tunables={}, verbose=False):\n         if verbose:\n             print(\"Pipe input given!\")\n         encoded = pipe.transform(df[catcols])\n-    return pd.concat([df, encoded], axis=1), pipe\n+\n+    for col in df.columns:\n+        if col not in encoded.columns:\n+            encoded[col] = df[col]\n+    return encoded, pipe\n \n \n def postproc_basic(feats, pipe=None, tunables={}, verbose=False):\n\nFile: src/features/gomez.py\nPatch:\n@@ -0,0 +1,69 @@\n+import numpy as np\n+import pandas as pd\n+from sklearn.pipeline import Pipeline\n+from sklearn.preprocessing import LabelEncoder, MinMaxScaler, RobustScaler\n+from src.features.common import read_non_sensor_data, read_sensors_from_file\n+\n+\n+def linear_approximation_model(rssi, TX, N):\n+    return np.power(10, (TX - rssi) / (10 * N))\n+\n+\n+def features(fp, key, tunables={}):\n+    # [0] Non-sensor data\n+    nsdata = read_non_sensor_data(fp, key)\n+    # [2] meanRSSI\n+    rssi_list = read_sensors_from_file(fp)[\"Bluetooth\"]\n+    rssi = np.array(rssi_list).mean()\n+    # [1] Predicted Distance\n+    if key.coarse_grain == \"Y\":\n+        params = tunables[\"cg=Y\"]\n+    else:\n+        params = tunables[\"cg=N\"]\n+    predicted_distance = linear_approximation_model(rssi, **params)\n+    # [3] Path Loss Attenuation\n+    path_loss = float(nsdata[\"Cat:TXPower\"]) - 41 - rssi\n+\n+    return {\n+        \"Num:PredictedDistance\": predicted_distance,\n+        \"Num:MeanRssi\": rssi,\n+        \"Num:Pat\n... (truncated)\n\nFile: src/models/evaluate.py\nPatch:\n@@ -6,13 +6,14 @@\n from src.hyperopt import optimize\n \n \n-def fit_rf(X, y, optimize_params=False, seed=0):\n-    rf = RandomForestClassifier(random_state=seed)\n+def fit_rf(X, y, optimize_params=False, seed=0, model=None):\n+    if model is None:\n+        model = RandomForestClassifier(random_state=seed)\n     if optimize_params:\n-        best_estim_ = optimize(rf, X, y)\n+        best_estim_ = optimize(model, X, y)\n         return best_estim_\n-    rf.fit(X, y)\n-    return rf\n+    model.fit(X, y)\n+    return model\n \n \n def evaluate(model, X, y):\n@@ -33,15 +34,15 @@ def generate_submission_output(trainset, testset, predictors, target, model=None\n \n \n def dual_evaluation(trainset, testset, predictors, target, seed=0,\n-                    save_system_output=False, optimize_params=False):\n+                    save_system_output=False, optimize_params=False, model=None):\n     report, predictions = {}, {}\n     for cg in [0, 1]:\n         _trainset = trainset[trainset[\"CoarseGrain\"] == cg]\n        \n... (truncated)\n\n\n=== PR #35 in Michael-OMahony/ml-labs-bootcamp-group-5 (Stars: 3) ===\nFile: src/models/evaluate.py\nPatch:\n@@ -1,7 +1,8 @@\n+import os\n+\n import pandas as pd\n from sklearn.ensemble import RandomForestClassifier\n from sklearn.metrics import classification_report\n-\n from src.hyperopt import optimize\n \n \n@@ -32,7 +33,7 @@ def generate_submission_output(trainset, testset, predictors, target, model=None\n \n \n def dual_evaluation(trainset, testset, predictors, target, seed=0,\n-                    save_system_output=True, optimize_params=False):\n+                    save_system_output=False, optimize_params=False):\n     report, predictions = {}, {}\n     for cg in [0, 1]:\n         _trainset = trainset[trainset[\"CoarseGrain\"] == cg]\n@@ -57,18 +58,11 @@ def dual_evaluation(trainset, testset, predictors, target, seed=0,\n         }\n     )\n     if save_system_output:\n+        sysout_dir = \"data/system_output/\"\n+        if not os.path.isdir(sysout_dir):\n+            os.mkdir(sysout_dir)\n         devset_system_output.to_csv(\n-            \"data/system_output/dev_system_output.tsv\", sep=\"\\t\", index=False\n+   \n... (truncated)\n\n\n=== PR #34 in Michael-OMahony/ml-labs-bootcamp-group-5 (Stars: 3) ===\nFile: src/dataset/common.py\nPatch:\n@@ -23,6 +23,50 @@ def read_ble_from_file(fp):\n     )\n \n \n+def read_sensors_from_file(fp):\n+    readings = {}\n+    lines = open(fp).read().split('\\n')[10:]\n+    for line in lines:\n+        items = line.split(',')\n+        anathema = [\"Activity\", \"scenario\", \"environment\", \"subject\",\n+                    \"session_id\", \"beacon\", \"receiver\", \"user_id\", \"Range\",\n+                    \"Angle\", \"beacon_subject\", \"partner_tester\", \"self_tester\",\n+                    \"partner_on_body_location\", \"partner_pose\", \"app_name\",\n+                    \"app_ver\", \"self_on_body_location\", \"self_pose\", \"self_activity\",\n+                    \"partner_activity\", \"app_name\", \"self_user_id\", \"Pedometer\",\n+                    \"partner_beacon_id\", \"self_beacon_id\"]\n+        if not line.strip():\n+            continue\n+        if items[1] in anathema:\n+            continue\n+        if \"Bluetooth\" in line:\n+            if \"Bluetooth\" not in readings:\n+                readings[\"Bluetooth\"] = []\n+            readings[\n... (truncated)\n\nFile: src/dataset/matrix.py\nPatch:\n@@ -1,5 +1,6 @@\n-from src.data.common import apply_fn_to_data_files, matrix_dir, read_ble_from_file\n import pandas as pd\n+from src.dataset.common import (apply_fn_to_data_files, matrix_dir,\n+                                read_ble_from_file, read_sensors_from_file, summarize_sensor)\n \n MATRIX_PROCESSED_DATA = \"data/processed/MIT-Matrix-Data.Bluetooth.csv\"\n \n@@ -11,27 +12,33 @@ def get_headers(fp):\n         if \"beacon\" in line and \"beacon_subject\" not in line:\n             a, b = line.split(\",\")[-2].strip(), line.split(\",\")[-1].strip()\n             devices[\"TX\"] = b if a == \"\" else a\n-            devices[\"TX\"] = devices[\"TX\"]  # + ' | ' + line\n+            devices[\"TX\"] = devices[\"TX\"].replace(\" \", \"\")  # + ' | ' + line\n         if \"receiver\" in line:\n             a, b = line.split(\",\")[-2].strip(), line.split(\",\")[-1].strip()\n             devices[\"RX\"] = b if a == \"\" else a\n-            devices[\"RX\"] = devices[\"RX\"]  # + ' | ' + line\n+            devices[\"RX\"] = devices[\"RX\"] .replace\n... (truncated)\n\n"
}