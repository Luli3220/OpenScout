{
  "username": "segiddins",
  "agent_b_context": "\n=== PR #873 in aasm/aasm (Stars: 5166) ===\nFile: lib/aasm/core/invokers/proc_invoker.rb\nPatch:\n@@ -30,11 +30,40 @@ def support_parameters?\n           subject.respond_to?(:parameters)\n         end\n \n+        def keyword_arguments?\n+          return false unless support_parameters?\n+          subject.parameters.any? { |type, _| [:key, :keyreq].include?(type) }\n+        end\n+\n+        def exec_proc_with_keyword_args(parameters_size)\n+          positional_args, keyword_args = parse_arguments\n+\n+          if keyword_args.nil?\n+            if parameters_size < 0\n+              record.instance_exec(*positional_args, &subject)\n+            else\n+              record.instance_exec(*positional_args[0..(parameters_size - 1)], &subject)\n+            end\n+          else\n+            if parameters_size < 0\n+              record.instance_exec(*positional_args, **keyword_args, &subject)\n+            else\n+              record.instance_exec(*positional_args[0..(parameters_size - 1)], **keyword_args, &subject)\n+            end\n+          end\n+        end\n+\n         # rubocop:disable Metrics/AbcSi\n... (truncated)\n\nFile: spec/models/active_record/validator.rb\nPatch:\n@@ -1,9 +1,11 @@\n class Validator < ActiveRecord::Base\n   attr_accessor :after_all_transactions_performed,\n     :after_transaction_performed_on_fail,\n+    :after_transaction_performed_on_fail_with_reason,\n     :after_transaction_performed_on_run,\n     :before_all_transactions_performed,\n     :before_transaction_performed_on_fail,\n+    :before_transaction_performed_on_fail_with_reason,\n     :before_transaction_performed_on_run,\n     :invalid\n \n@@ -51,6 +53,18 @@ class Validator < ActiveRecord::Base\n \n       transitions :to => :failed, :from => [:sleeping, :running]\n     end\n+\n+    event :fail_with_reason do\n+      after_transaction do |reason:, **|\n+        @after_transaction_performed_on_fail_with_reason = reason\n+      end\n+\n+      before_transaction do |reason:, **|\n+        @before_transaction_performed_on_fail_with_reason = reason\n+      end\n+\n+      transitions :to => :failed, :from => [:sleeping, :running]\n+    end\n   end\n \n   validates_presence_of :name\n\nFile: spec/unit/invokers/proc_invoker_spec.rb\nPatch:\n@@ -82,5 +82,54 @@\n         expect { subject.invoke_subject }.not_to raise_error\n       end\n     end\n+\n+    context 'when passing keyword arguments' do\n+      let(:args) { [1, key: 2] }\n+      let(:target) { ->(_a, key: nil) {} }\n+\n+      it 'then correctly uses passed keyword arguments' do\n+        expect { subject.invoke_subject }.not_to raise_error\n+      end\n+    end\n+\n+    context 'when passing optional keyword arguments' do\n+      let(:args) { [1, foo: 1] }\n+      let(:target) { ->(_a, key: nil, foo:) {} }\n+\n+      it 'then correctly uses passed keyword arguments' do\n+        expect { subject.invoke_subject }.not_to raise_error\n+      end\n+    end\n+\n+    context 'when passing required keyword arguments like the failing test' do\n+      let(:args) { [reason: 'test_reason'] }\n+      let(:target) { proc { |reason:, **| @reason = reason } }\n+\n+      it 'should pass the keyword arguments correctly' do\n+        subject.invoke_subject\n+        expect(record.instance_variable_get(:@reason\n... (truncated)\n\nFile: spec/unit/persistence/active_record_persistence_spec.rb\nPatch:\n@@ -708,6 +708,18 @@\n               expect(validator).to_not be_running\n             end\n \n+            it \"should fire :#{event_type}_transaction if transaction failed w/ kwarg\" do\n+              validator = Validator.create(:name => 'name')\n+              expect do\n+                begin\n+                  validator.fail_with_reason!(reason: 'reason')\n+                rescue => ignored\n+                  expect(ignored).not_to be_instance_of(ArgumentError)\n+                end\n+              end.to change { validator.send(\"#{event_type}_transaction_performed_on_fail_with_reason\") }.from(nil).to('reason')\n+              expect(validator).to_not be_running\n+            end\n+\n             it \"should not fire :#{event_type}_transaction if not saving\" do\n               validator = Validator.create(:name => 'name')\n               expect(validator).to be_sleeping\n\n\n=== PR #972 in zizmorcore/zizmor (Stars: 3466) ===\nFile: crates/zizmor/src/audit/mod.rs\nPatch:\n@@ -1,6 +1,5 @@\n //! Core namespace for zizmor's audits.\n \n-use line_index::LineIndex;\n use thiserror::Error;\n use tracing::instrument;\n use yamlpath::Document;\n@@ -32,6 +31,7 @@ pub(crate) mod known_vulnerable_actions;\n pub(crate) mod obfuscation;\n pub(crate) mod overprovisioned_secrets;\n pub(crate) mod ref_confusion;\n+pub(crate) mod ref_version_mismatch;\n pub(crate) mod secrets_inherit;\n pub(crate) mod self_hosted_runner;\n pub(crate) mod stale_action_refs;\n@@ -58,13 +58,6 @@ impl AuditInput {\n         }\n     }\n \n-    pub(crate) fn line_index(&self) -> &LineIndex {\n-        match self {\n-            AuditInput::Workflow(workflow) => workflow.as_document().line_index(),\n-            AuditInput::Action(action) => action.as_document().line_index(),\n-        }\n-    }\n-\n     pub(crate) fn link(&self) -> Option<&str> {\n         match self {\n             AuditInput::Workflow(workflow) => workflow.link.as_deref(),\n\n\n=== PR #73 in spinel-coop/rv (Stars: 1521) ===\nFile: crates/rv/src/config/ruby_cache.rs\nPatch:\n@@ -1,6 +1,7 @@\n use camino::Utf8Path;\n use miette::{IntoDiagnostic, Result};\n use rayon::prelude::*;\n+use rayon_tracing::TracedIndexedParallelIterator;\n use tracing::debug;\n \n use rv_ruby::Ruby;\n@@ -117,6 +118,7 @@ impl Config {\n         // Process Ruby paths in parallel for better performance\n         let mut rubies: Vec<Ruby> = ruby_paths\n             .into_par_iter()\n+            .indexed_in_span(tracing::span::Span::current())\n             .filter_map(|ruby_path| {\n                 // Try to get Ruby from cache first\n                 match self.get_cached_ruby(&ruby_path) {\n\n"
}