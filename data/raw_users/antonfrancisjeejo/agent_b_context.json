{
  "username": "antonfrancisjeejo",
  "agent_b_context": "\n=== PR #12 in venuvikaash/drag-and-drop-react (Stars: 0) ===\n\n=== Fallback Source Audit: tests/test_routes.py (Size: 4707 bytes) ===\nimport json\nfrom datetime import date\nfrom decimal import Decimal\n\nfrom app.models import Plan, db\n\n\ndef test_health_endpoint(client):\n    response = client.get('/health')\n    assert response.status_code == 200\n    data = json.loads(response.data)\n    assert data == {'status': 'ok'}\n\n\ndef test_plans_endpoint_empty(client):\n    response = client.get('/plans')\n    assert response.status_code == 200\n    data = json.loads(response.data)\n    assert 'plans' in data\n    assert data['plans'] == []\n    assert data['total'] == 0\n\n\ndef test_plans_endpoint_with_data(client, sample_plan_data):\n    plan = Plan(\n        date=date(2025, 11, 1),\n        country=sample_plan_data['country'],\n        website=sample_plan_data['website'],\n        currency=sample_plan_data['currency'],\n        provider_name=sample_plan_data['provider_name'],\n        segment=sample_plan_data['segment'],\n        plan_name=sample_plan_data['plan_name'],\n        actual_price=Decimal(sample_plan_data['actual_price']),\n        promo_price=Decimal(sample_plan_data['promo_price']),\n        promo_months=int(sample_plan_data['promo_months']),\n        upfront_charge=Decimal(sample_plan_data['upfront_charge']),\n        contract_length_months=int(sample_plan_data['contract_length_months']),\n        total_data_gb=Decimal(sample_plan_data['total_data_gb']),\n        url=sample_plan_data['url'],\n    )\n    db.session.add(plan)\n    db.session.commit()\n    \n    response = client.get('/plans')\n    assert response.status_code == 200\n    data = json.loads(response.data)\n    \n    assert 'plans' in data\n    assert len(data['plans']) == 1\n    assert data['total'] == 1\n    \n    plan_data = data['plans'][0]\n    \n    required_fields = [\n        'id', 'date', 'country', 'website', 'currency', 'provider_name',\n        'segment', 'plan_name', 'actual_price', 'promo_price', 'promo_months',\n        'upfront_charge', 'contract_length_months', 'total_data_gb',\n        'total_cost', 'average_monthly_price', 'two_year_cost',\n        'eur_conversion_rate', 'total_cost_eur', 'average_monthly_price_eur',\n        'two_year_cost_eur', 'url'\n    ]\n    \n    for field in required_fields:\n        assert field in plan_data, f\"Missing field: {field}\"\n\n\ndef test_get_single_plan(client, sample_plan_data):\n    plan = Plan(\n        date=date(2025, 11, 1),\n        country=sample_plan_data['country'],\n        website=sample_plan_data['website'],\n        currency=sample_plan_data['currency'],\n        provider_name=sample_plan_data['provider_name'],\n        segment=sample_plan_data['segment'],\n        plan_name=sample_plan_data['plan_name'],\n        actual_price=Decimal(sample_plan_data['actual_price']),\n        promo_price=Decimal(sample_plan_data['promo_price']),\n        promo_months=int(sample_plan_data['promo_months']),\n        upfront_charge=Decimal(sample_plan_data['upfront_charge']),\n        contract_length_months=int(sample_plan_data['contract_length_months']),\n        total_data_gb=Decimal(sample_plan_data['total_data_gb']),\n       \n... (file truncated)\n"
}