{
  "username": "mfussenegger",
  "agent_b_context": "\n=== PR #18848 in crate/crate (Stars: 4346) ===\nFile: server/src/main/java/org/elasticsearch/index/seqno/ReplicationTracker.java\nPatch:\n@@ -45,7 +45,6 @@\n import org.elasticsearch.Version;\n import org.elasticsearch.action.ActionListener;\n import org.elasticsearch.action.support.replication.ReplicationResponse;\n-import org.elasticsearch.cluster.metadata.IndexMetadata;\n import org.elasticsearch.cluster.routing.AllocationId;\n import org.elasticsearch.cluster.routing.IndexShardRoutingTable;\n import org.elasticsearch.cluster.routing.ShardRouting;\n@@ -67,7 +66,6 @@\n \n import io.crate.common.SuppressForbidden;\n import io.crate.common.collections.Tuple;\n-import io.crate.concurrent.MultiActionListener;\n \n /**\n  * This class is responsible for tracking the replication group with its progress and safety markers (local and global checkpoints).\n@@ -208,14 +206,6 @@ public class ReplicationTracker extends AbstractIndexShardComponent implements L\n      */\n     private long persistedRetentionLeasesVersion;\n \n-    /**\n-     * Whether there should be a peer recovery retention lease (PRRL) for every tracked shard copy. Always true on ind\n... (truncated)\n\nFile: server/src/main/java/org/elasticsearch/index/shard/IndexShard.java\nPatch:\n@@ -29,7 +29,6 @@\n import java.util.Collection;\n import java.util.Collections;\n import java.util.EnumSet;\n-import java.util.HashSet;\n import java.util.List;\n import java.util.Locale;\n import java.util.Map;\n@@ -230,7 +229,6 @@ public RetentionLeaseSyncer getRetentionLeaseSyncer() {\n     private final AtomicLong lastSearcherAccess = new AtomicLong();\n     private final AtomicReference<Translog.Location> pendingRefreshLocation = new AtomicReference<>();\n     private final RefreshPendingLocationListener refreshPendingLocationListener;\n-    private volatile boolean useRetentionLeasesInPeerRecovery;\n \n     private final Analyzer indexAnalyzer;\n \n@@ -255,7 +253,6 @@ public IndexShard(\n         super(shardRouting.shardId(), indexSettings);\n         assert shardRouting.initializing();\n         this.shardRouting = shardRouting;\n-        final Settings settings = indexSettings.getSettings();\n         this.codecService = new CodecService();\n         Objects.requireNonNull(store, \"Store must be pro\n... (truncated)\n\nFile: server/src/main/java/org/elasticsearch/indices/recovery/RecoverySourceHandler.java\nPatch:\n@@ -183,7 +183,7 @@ public void recoverToTarget(ActionListener<RecoveryResponse> listener) {\n             }, shardId + \" validating recovery target [\" + request.targetAllocationId() + \"] registered \",\n                 shard, cancellableThreads, logger);\n             final Engine.HistorySource historySource;\n-            if (shard.useRetentionLeasesInPeerRecovery() || retentionLeaseRef.get() != null) {\n+            if (retentionLeaseRef.get() != null) {\n                 historySource = Engine.HistorySource.INDEX;\n             } else {\n                 historySource = Engine.HistorySource.TRANSLOG;\n\nFile: server/src/test/java/org/elasticsearch/indices/recovery/IndexRecoveryIT.java\nPatch:\n@@ -24,6 +24,7 @@\n import static com.carrotsearch.randomizedtesting.RandomizedTest.biasedDoubleBetween;\n import static io.crate.testing.Asserts.assertThat;\n import static java.util.Collections.singletonMap;\n+import static org.assertj.core.api.Assertions.assertThat;\n import static org.elasticsearch.node.RecoverySettingsChunkSizePlugin.CHUNK_SIZE_SETTING;\n \n import java.io.IOException;\n@@ -1291,8 +1292,10 @@ public Settings onNodeStopped(String nodeName) throws Exception {\n \n         ensureGreen();\n \n-        execute(\"select recovery['files']['used'] from sys.shards where table_name='test' and primary=false\");\n-        assertThat((int)response.rows()[0][0]).isGreaterThan(0);\n+        execute(\"select recovery['stage'], recovery['type'] from sys.shards where table_name='test' and primary=false\");\n+        assertThat(response).hasRows(\n+            \"DONE| PEER\"\n+        );\n     }\n \n     @Test\n\n\n=== PR #18849 in crate/crate (Stars: 4346) ===\nFile: server/src/main/java/org/elasticsearch/action/admin/cluster/configuration/AddVotingConfigExclusionsRequest.java\nPatch:\n@@ -84,7 +84,6 @@ public AddVotingConfigExclusionsRequest(String[] nodeDescriptions, String[] node\n                 \"One and only one of [node_name], [node_names] and [node_ids] has to be set\");\n         }\n \n-        System.out.println(\"nodeDescs: \" + nodeDescriptions);\n         if (nodeDescriptions.length > 0) {\n             DEPRECATION_LOGGER.deprecatedAndMaybeLog(\"voting_config_exclusion\", DEPRECATION_MESSAGE);\n         }\n\n\n=== PR #18847 in crate/crate (Stars: 4346) ===\nFile: server/src/main/java/org/elasticsearch/action/admin/cluster/node/stats/TransportNodesStats.java\nPatch:\n@@ -24,14 +24,14 @@\n \n import org.elasticsearch.action.ActionType;\n import org.elasticsearch.action.FailedNodeException;\n-import org.elasticsearch.action.support.nodes.BaseNodeRequest;\n import org.elasticsearch.action.support.nodes.TransportNodesAction;\n import org.elasticsearch.cluster.service.ClusterService;\n import org.elasticsearch.common.inject.Inject;\n import org.elasticsearch.common.io.stream.StreamInput;\n import org.elasticsearch.common.io.stream.StreamOutput;\n import org.elasticsearch.node.NodeService;\n import org.elasticsearch.threadpool.ThreadPool;\n+import org.elasticsearch.transport.TransportRequest;\n import org.elasticsearch.transport.TransportService;\n \n public class TransportNodesStats extends TransportNodesAction<NodesStatsRequest, NodesStatsResponse, TransportNodesStats.NodeStatsRequest, NodeStats> {\n@@ -85,7 +85,7 @@ protected NodeStats nodeOperation(NodeStatsRequest nodeStatsRequest) {\n         return nodeService.stats();\n     }\n \n-    public static class NodeStatsRe\n... (truncated)\n\n"
}