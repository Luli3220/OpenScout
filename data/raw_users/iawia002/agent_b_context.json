{
  "username": "iawia002",
  "agent_b_context": "\n=== PR #23929 in argoproj/argo-cd (Stars: 21503) ===\nFile: cmd/argocd-notification/commands/controller.go\nPatch:\n@@ -11,16 +11,6 @@ import (\n \t\"sync\"\n \t\"syscall\"\n \n-\t\"github.com/argoproj/argo-cd/v3/common\"\n-\t\"github.com/argoproj/argo-cd/v3/reposerver/apiclient\"\n-\n-\t\"github.com/argoproj/argo-cd/v3/util/env\"\n-\t\"github.com/argoproj/argo-cd/v3/util/errors\"\n-\tservice \"github.com/argoproj/argo-cd/v3/util/notification/argocd\"\n-\t\"github.com/argoproj/argo-cd/v3/util/tls\"\n-\n-\tnotificationscontroller \"github.com/argoproj/argo-cd/v3/notification_controller/controller\"\n-\n \t\"github.com/argoproj/notifications-engine/pkg/controller\"\n \t\"github.com/prometheus/client_golang/prometheus\"\n \t\"github.com/prometheus/client_golang/prometheus/promhttp\"\n@@ -30,22 +20,21 @@ import (\n \t\"k8s.io/client-go/kubernetes\"\n \t_ \"k8s.io/client-go/plugin/pkg/client/auth/gcp\"\n \t\"k8s.io/client-go/tools/clientcmd\"\n+\n+\t\"github.com/argoproj/argo-cd/v3/common\"\n+\tnotificationscontroller \"github.com/argoproj/argo-cd/v3/notification_controller/controller\"\n+\t\"github.com/argoproj/argo-cd/v3/reposerver/apiclient\"\n+\t\"github.com/argoproj/argo-cd/v3/u\n... (truncated)\n\n\n=== PR #23839 in argoproj/argo-cd (Stars: 21503) ===\nFile: cmd/argocd-notification/commands/controller.go\nPatch:\n@@ -50,7 +50,6 @@ func NewCommand() *cobra.Command {\n \tvar (\n \t\tclientConfig                   clientcmd.ClientConfig\n \t\tprocessorsCount                int\n-\t\tnamespace                      string\n \t\tappLabelSelector               string\n \t\tlogLevel                       string\n \t\tlogFormat                      string\n@@ -178,7 +177,6 @@ func NewCommand() *cobra.Command {\n \tclientConfig = addK8SFlagsToCmd(&command)\n \tcommand.Flags().IntVar(&processorsCount, \"processors-count\", 1, \"Processors count.\")\n \tcommand.Flags().StringVar(&appLabelSelector, \"app-label-selector\", \"\", \"App label selector.\")\n-\tcommand.Flags().StringVar(&namespace, \"namespace\", \"\", \"Namespace which controller handles. Current namespace if empty.\")\n \tcommand.Flags().StringVar(&logLevel, \"loglevel\", env.StringFromEnv(\"ARGOCD_NOTIFICATIONS_CONTROLLER_LOGLEVEL\", \"info\"), \"Set the logging level. One of: debug|info|warn|error\")\n \tcommand.Flags().StringVar(&logFormat, \"logformat\", env.StringFromEnv(\"ARGOCD_NOTIFICATIONS_CON\n... (truncated)\n\n\n=== PR #5752 in k0sproject/k0s (Stars: 5622) ===\nFile: cmd/controller/certificates.go\nPatch:\n@@ -54,7 +54,7 @@ func (c *Certificates) Init(ctx context.Context) error {\n \tcaCertPath := filepath.Join(c.K0sVars.CertRootDir, \"ca.crt\")\n \tcaCertKey := filepath.Join(c.K0sVars.CertRootDir, \"ca.key\")\n \n-\tif err := c.CertManager.EnsureCA(\"ca\", \"kubernetes-ca\"); err != nil {\n+\tif err := c.CertManager.EnsureCA(\"ca\", \"kubernetes-ca\", c.ClusterSpec.API.CAExpiry.Duration); err != nil {\n \t\treturn err\n \t}\n \n@@ -76,7 +76,7 @@ func (c *Certificates) Init(ctx context.Context) error {\n \t}\n \teg.Go(func() error {\n \t\t// Front proxy CA\n-\t\tif err := c.CertManager.EnsureCA(\"front-proxy-ca\", \"kubernetes-front-proxy-ca\"); err != nil {\n+\t\tif err := c.CertManager.EnsureCA(\"front-proxy-ca\", \"kubernetes-front-proxy-ca\", c.ClusterSpec.API.CAExpiry.Duration); err != nil {\n \t\t\treturn err\n \t\t}\n \n@@ -89,7 +89,7 @@ func (c *Certificates) Init(ctx context.Context) error {\n \t\t\tCACert: proxyCertPath,\n \t\t\tCAKey:  proxyCertKey,\n \t\t}\n-\t\t_, err := c.CertManager.EnsureCertificate(proxyClientReq, apiServerUID)\n+\t\t_, err := \n... (truncated)\n\nFile: cmd/kubeconfig/create.go\nPatch:\n@@ -20,6 +20,7 @@ import (\n \t\"errors\"\n \t\"fmt\"\n \t\"path/filepath\"\n+\t\"time\"\n \n \t\"github.com/k0sproject/k0s/internal/pkg/users\"\n \t\"github.com/k0sproject/k0s/pkg/certificate\"\n@@ -91,7 +92,7 @@ func createUserKubeconfig(k0sVars *config.CfgVars, clusterAPIURL, username, grou\n \tcertManager := certificate.Manager{\n \t\tK0sVars: k0sVars,\n \t}\n-\tuserCert, err := certManager.EnsureCertificate(userReq, users.RootUID)\n+\tuserCert, err := certManager.EnsureCertificate(userReq, users.RootUID, 8760*time.Hour)\n \tif err != nil {\n \t\treturn nil, fmt.Errorf(\"failed generate user certificate: %w, check if the control plane is initialized on this node\", err)\n \t}\n\nFile: cmd/kubeconfig/create_test.go\nPatch:\n@@ -21,6 +21,7 @@ import (\n \t\"os\"\n \t\"path/filepath\"\n \t\"testing\"\n+\t\"time\"\n \n \t\"github.com/k0sproject/k0s/cmd\"\n \t\"github.com/k0sproject/k0s/pkg/apis/k0s/v1beta1\"\n@@ -46,7 +47,7 @@ func TestKubeconfigCreate(t *testing.T) {\n \t// Create the CA\n \trequire.NoError(t, os.MkdirAll(k0sVars.CertRootDir, 0755))\n \tcertManager := certificate.Manager{K0sVars: k0sVars}\n-\trequire.NoError(t, certManager.EnsureCA(\"ca\", t.Name()))\n+\trequire.NoError(t, certManager.EnsureCA(\"ca\", t.Name(), 87600*time.Hour))\n \n \t// Setup the kubeconfig command\n \tconfigData, err := yaml.Marshal(cfg)\n\nFile: pkg/apis/k0s/v1beta1/api.go\nPatch:\n@@ -22,10 +22,12 @@ import (\n \t\"net\"\n \t\"net/url\"\n \t\"strconv\"\n+\t\"time\"\n \n \t\"github.com/k0sproject/k0s/internal/pkg/iface\"\n \t\"github.com/k0sproject/k0s/internal/pkg/stringslice\"\n \n+\tmetav1 \"k8s.io/apimachinery/pkg/apis/meta/v1\"\n \t\"k8s.io/apimachinery/pkg/util/validation\"\n \t\"k8s.io/apimachinery/pkg/util/validation/field\"\n \n@@ -64,6 +66,14 @@ type APISpec struct {\n \t// List of additional addresses to push to API servers serving the certificate\n \t// +listType=set\n \tSANs []string `json:\"sans,omitempty\"`\n+\n+\t// The expiration duration of the CA certificate\n+\t// +kubebuilder:default=\"87600h\"\n+\tCAExpiry metav1.Duration `json:\"caExpiry,omitempty\"`\n+\n+\t// The expiration duration of the server certificate\n+\t// +kubebuilder:default=\"8760h\"\n+\tCertExpiry metav1.Duration `json:\"certExpiry,omitempty\"`\n }\n \n // DefaultAPISpec default settings for api\n@@ -195,4 +205,14 @@ func (a *APISpec) setDefaults() {\n \tif a.Port == 0 {\n \t\ta.Port = 6443\n \t}\n+\tif a.CAExpiry.Duration == 0 {\n+\t\ta.CAExpiry = metav1.Durat\n... (truncated)\n\n"
}