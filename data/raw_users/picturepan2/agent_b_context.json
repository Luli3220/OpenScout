{
  "username": "picturepan2",
  "agent_b_context": "\n=== PR #356 in web3bio/web3bio-profile-api (Stars: 5) ===\nFile: app/api/[handle]/route.ts\nPatch:\n@@ -1,5 +1,5 @@\n import type { NextRequest } from \"next/server\";\n-import { BASE_URL, errorHandle, respondWithCache } from \"@/utils/utils\";\n+import { BASE_URL, errorHandle, respondJson } from \"@/utils/utils\";\n import { ErrorMessages } from \"web3bio-profile-kit/types\";\n import { resolveIdentity } from \"web3bio-profile-kit/utils\";\n \n@@ -39,5 +39,5 @@ export async function GET(\n     avatar: `${BASE_URL}/avatar/${handle}`,\n   };\n \n-  return respondWithCache(responseData);\n+  return respondJson(responseData);\n }\n\nFile: app/api/avatar/svg/[handle]/route.ts\nPatch:\n@@ -1,26 +1,20 @@\n import { type NextRequest } from \"next/server\";\n import { respondWithSVG } from \"./utils\";\n \n+const AVATAR_SIZE = 240;\n+const EMPTY_AVATAR_SVG = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${AVATAR_SIZE}\" height=\"${AVATAR_SIZE}\"><rect width=\"${AVATAR_SIZE}\" height=\"${AVATAR_SIZE}\" fill=\"#ccc\"/></svg>`;\n+\n export async function GET(\n-  req: NextRequest,\n+  _req: NextRequest,\n   props: { params: Promise<{ handle: string }> },\n ) {\n-  const params = await props.params;\n-  const handle = params.handle;\n+  const { handle } = await props.params;\n \n-  // Early validation - return minimal SVG for empty handles\n   if (!handle) {\n-    return new Response(\n-      '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"240\" height=\"240\"><rect width=\"240\" height=\"240\" fill=\"#ccc\"/></svg>',\n-      {\n-        headers: {\n-          \"Content-Type\": \"image/svg+xml\",\n-          \"Cache-Control\":\n-            \"public, max-age=604800, s-maxage=604800, stale-while-revalidate=86400\",\n-        }\n... (truncated)\n\nFile: app/api/credential/[handle]/utils.ts\nPatch:\n@@ -7,7 +7,7 @@ import {\n } from \"web3bio-profile-kit/types\";\n import { QueryType, queryIdentityGraph } from \"@/utils/query\";\n import type { AuthHeaders, CredentialRecord } from \"@/utils/types\";\n-import { errorHandle, respondWithCache } from \"@/utils/utils\";\n+import { errorHandle, respondJson } from \"@/utils/utils\";\n import { CREDENTIAL_INFO } from \"@/utils/credential\";\n import { isSameAddress } from \"web3bio-profile-kit/utils\";\n \n@@ -19,33 +19,31 @@ interface CredentialVertice {\n \n type CredentialCategory = keyof CredentialResponse;\n \n-const checkIsHuman = (item: CredentialRecord): boolean => {\n-  return (\n-    item.value === \"true\" ||\n-    (item.dataSource === CredentialSource.humanPassport &&\n-      Number(item.value) >= 20)\n-  );\n-};\n-\n-const checkIsRisky = (item: CredentialRecord): boolean => {\n-  return (\n-    Boolean(CREDENTIAL_INFO[item.dataSource as CredentialSource]) &&\n-    item.value === \"true\"\n-  );\n-};\n-\n-const checkIsSpam = (item: CredentialRecord): boolean => {\n-  retur\n... (truncated)\n\nFile: app/api/domain/[handle]/utils.ts\nPatch:\n@@ -1,6 +1,6 @@\n import type { IdentityRecord, AuthHeaders } from \"@/utils/types\";\n import { queryIdentityGraph, QueryType } from \"@/utils/query\";\n-import { errorHandle, formatTimestamp, respondWithCache } from \"@/utils/utils\";\n+import { errorHandle, formatTimestamp, respondJson } from \"@/utils/utils\";\n import { ErrorMessages, Platform } from \"web3bio-profile-kit/types\";\n import { isSameAddress } from \"web3bio-profile-kit/utils\";\n \n@@ -12,61 +12,46 @@ export const VALID_DOMAIN_PLATFORMS = new Set([\n   Platform.basenames,\n   Platform.linea,\n ]);\n+\n const EXTEND_DOMAIN_PLATFORMS = new Set([Platform.ethereum, Platform.solana]);\n const TARGET_PLATFORMS = new Set([Platform.ens, Platform.sns]);\n \n-const generateResponseStruct = (identity: IdentityRecord) => {\n-  const {\n-    profile,\n-    isPrimary,\n-    status,\n-    registeredAt,\n-    updatedAt,\n-    expiredAt,\n-    resolver,\n-  } = identity;\n+const formatAddress = (addr?: Array<{ address: string }>) =>\n+  addr?.[0]?.address ?? null;\n \n-  r\n... (truncated)\n\nFile: app/api/ns/batch/[ids]/route.ts\nPatch:\n@@ -1,6 +1,6 @@\n import type { NextRequest } from \"next/server\";\n import { ErrorMessages } from \"web3bio-profile-kit/types\";\n-import { errorHandle, getUserHeaders, respondWithCache } from \"@/utils/utils\";\n+import { errorHandle, getUserHeaders, respondJson } from \"@/utils/utils\";\n import { queryIdentityGraphBatch } from \"@/utils/query\";\n \n type RouteParams = {\n@@ -43,7 +43,7 @@ export async function GET(req: NextRequest, { params }: RouteParams) {\n     }\n \n     const resJson = await queryIdentityGraphBatch(ids, true, headers);\n-    return respondWithCache(resJson);\n+    return respondJson(resJson);\n   } catch (e: unknown) {\n     // More specific error handling for JSON parsing vs other errors\n     const isParseError = e instanceof SyntaxError;\n\nFile: app/api/ns/batch/universal/[ids]/route.ts\nPatch:\n@@ -1,6 +1,6 @@\n import type { NextRequest } from \"next/server\";\n import { ErrorMessages } from \"web3bio-profile-kit/types\";\n-import { errorHandle, getUserHeaders, respondWithCache } from \"@/utils/utils\";\n+import { errorHandle, getUserHeaders, respondJson } from \"@/utils/utils\";\n import { queryBatchUniversal } from \"@/utils/query\";\n \n type RouteParams = {\n@@ -43,7 +43,7 @@ export async function GET(req: NextRequest, { params }: RouteParams) {\n     }\n \n     const resJson = await queryBatchUniversal(ids, headers);\n-    return respondWithCache(resJson);\n+    return respondJson(resJson);\n   } catch (e: unknown) {\n     // More specific error handling for JSON parsing vs other errors\n     const isParseError = e instanceof SyntaxError;\n\n\n=== PR #354 in web3bio/web3bio-profile-api (Stars: 5) ===\n\n=== PR #353 in web3bio/web3bio-profile-api (Stars: 5) ===\n"
}